<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Animais do Bem</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
	<link rel="stylesheet" href="../css/style.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,opsz,wght@0,18..144,300..900;1,18..144,300..900&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Old+Standard+TT:ital,wght@0,400;0,700;1,400&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Sour+Gummy:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>

<body>
	<header>
		<nav class="navbar navbar-expand-md navbar-light">
			<div class="container">
				<img src="../resources/img/logo.png" alt="Logo" width="120" height="50" class="d-inline-block align-text-top">

				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menuNav" aria-controls="menuNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="menuNav">
					<ul class="navbar-nav me-auto mb-2 mb-lg-0">
						<li class="nav-item"><a class="nav-link" href="home.html">Home</a></li>
						<li class="nav-item"><a class="nav-link" href="quemsomos.html">Quem Somos</a></li>
						<li class="nav-item"><a class="nav-link" href="adote.html">Adote</a></li>
						<li class="nav-item"><a class="nav-link" href="doar.html">Doar</a></li>
						<li class="nav-item"><a class="nav-link" href="parceiros.html">Parceiros</a></li>
						<li class="nav-item"><a class="nav-link" href="portal.html">Portal da Transparência</a></li>
					</ul>

					<div>
						<a class="btn btn-login me-2" href="login.html">Login</a>
					</div>
				</div>
			</div>
		</nav>
	</header>

	<main>
		<div class="container-principal">
			<h1>Já possui uma conta?</h1>

			<form id="loginForm" class="login-form">
				<fieldset>
					<div class="campo">
						<label for="email">E-mail:</label>
						<input type="email" id="email" name="email" placeholder="Digite seu e-mail" required>
					</div>

					<div class="campo">
						<label for="password">Senha:</label>
						<input type="password" id="password" name="senha" placeholder="Digite sua senha" required>
					</div>

					<div id="mensagem-erro" style="color: red; text-align: center; margin-bottom: 10px;"></div>

					<div class="acoes">
						<button type="submit" class="btn">Acessar</button>
						<a href="cadastrar.html" class="link-cadastrar">Não possui uma conta? Cadastre-se!</a>
					</div>
				</fieldset>
			</form>
		</div>
	</main>

	<footer>
		<p>&copy; 2025 Animais do Bem. Todos os direitos reservados.</p>
		<p>Contato: <a href="mailto:contato@animaisdobem.org">animaisdobem@ifsp.edu.br</a></p>
	</footer>

	<script>
		const API_URL = 'http://localhost:8080/adocao/login';
		document.getElementById('loginForm').addEventListener('submit', async function(event) {
			event.preventDefault();

			const email = document.getElementById('email').value;
			const senha = document.getElementById('password').value;
			const msgErro = document.getElementById('mensagem-erro');

			msgErro.textContent = 'Carregando...';

			try {
				const response = await fetch(API_URL, {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({ email: email, senha: senha })
				});

				if (response.ok) {
					const usuario = await response.json();

					localStorage.setItem('usuarioLogado', JSON.stringify(usuario));

					if (usuario.tipoUsuario === 'administrador') {
						window.location.href = 'admin/admin_dashboard.html';
					} else if (usuario.tipoUsuario === 'funcionario') {
						// Redireciona funcionário para sua página inicial
						window.location.href = 'func/funcionario_animais.html'; 
					} else {
						window.location.href = 'home.html';
					}

				} else {
							const erro = await response.json();
							msgErro.textContent = erro.error || 'Erro ao fazer login.';
						}
			} catch (error) {
				console.error('Erro:', error);
				msgErro.textContent = 'Erro de conexão com o servidor.';
			}
		});
	</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
